{% extends 'master.html' %}
{% load staticfiles %}
{% load i18n %}
{% load humanize %}


{% block title %}
  {% trans 'Emails' %}
{% endblock %}

{% block content %}

  <div class='container'>
    <div class='row'>
      <div class='col-lg-6 col-sm-6'>
        <h3>
          {% trans "Emails" %}
        </h3>
      </div>
      <div class='col-lg-6 col-sm-6 text-right'>
        <br />
        <a class='btn btn-default' href='{% url "campaign-new" %}'>{% trans 'Compose email' %}</a>
      </div>
    </div>

    <hr />

    <div class='row'>
      <div class='col-lg-12'>
        <div class="list-group">
          {% for campaign in object_list %}
            <a href="{% url 'campaign-detail' campaign.id %}" class="list-group-item">
              <h4 class="list-group-item-heading">
                <small>
                  {% if campaign.is_sent %}
                  <span class='label label-success'>SENT</span>
                  {% else %}
                  <span class='label label-warning'>NOT SENT</span>
                  {% endif %}
                </small>
                {{ campaign.email_subject }}
              </h4>
              <p class="list-group-item-text">
              {% if campaign.is_sent %}
              Sent to {{campaign.recipient_count|default:'0'|intcomma}}
              subscriber{{campaign.recipient_count|pluralize}}
              <br />
              {% endif %}
              <strong>From:</strong> {{ campaign.email_from_name }} &lt;{{ campaign.email_from_email }}&gt;
              <br />
              <strong>To recipients:</strong> {{ campaign.email_list }} &mdash; {{ campaign.email_list.count_validated_subscribers|intcomma }} subscriber{{ campaign.email_list.count_validated_subscribers|pluralize }}
              <br />
              <small class='text-muted' title='{{ campaign.created }}'>created: {{ campaign.created|timesince }} ago</small>
              </p>
            </a>
          {% empty %}
            <div class='alert alert-warning'>
              No email composed yet.
              <a href="{% url 'campaign-new' %}">Go compose one &raquo;</a>
            </div>
          {% endfor %}
        </div>
      </div>
    </div>
  </div>


{% endblock %}
