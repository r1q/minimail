{% extends 'master.html' %}
{% load i18n %}
{% load humanize %}


{% block title %}
  Campaign "{{ campaign.name }}"
{% endblock %}


{% block content %}

  <div class='row'>
    <div class='col-lg-12'>
      <h3>
        <a href='{% url 'campaign-list' %}'>{% trans "Campaigns" %}</a>
        / <a href='{% url 'campaign-detail' campaign.id %}'>{{ campaign.name }}</a>
        / {% trans 'Campaign review' %}
      </h3>
    </div>
  </div>

  <hr />

  <div class='row'>
    <div class='col-lg-8 col-lg-offset-2'>

      <div class="panel panel-default">
        <ul class="list-group">
          <li class="list-group-item">
            <strong>To recipient list:</strong>
            {{ campaign.email_list }} &mdash;
            {{campaign.email_list.count_subscribers|intcomma}}
            {% trans 'subscriber' %}{{campaign.email_list.count_subscribers|pluralize}}
            <a href='{% url "campaign-update" campaign.id %}'><small>edit</small></a>
          </li>
          <li class="list-group-item">
            <strong>From:</strong>
            {{ campaign.email_from_name}} &lt;{{campaign.email_from_email}}&gt;
            <a href='{% url "campaign-update" campaign.id %}'><small>edit</small></a>
          </li>
          <li class="list-group-item">
            <strong>Subject:</strong>
            {{ campaign.email_subject}}
            <a href='{% url "campaign-update" campaign.id %}'><small>edit</small></a>
          </li>
          <li class="list-group-item text-center">
            <strong>HTML email</strong>
            <a href='{% url "campaign-update" campaign.id %}'><small>edit</small></a>
            <div class='preview' style='position: relative; min-height: 600px; height:auto; background: #f9f9f9; overflow: hidden;margin-top:2rem'>
              <iframe style='border: 0; position: absolute; top: 0; bottom: 0; left: 0; right: 0; z-index: 10; transform: scale(0.90); transform-origin: 0 0; height: 112%; width: 112%;'
                src='{% url "template-preview" campaign.email_template.id %}'> </iframe>
              <div class='cover' style='position: absolute; top: 0; bottom: 0; left: 0; right: 0; z-index: 100;'></div>
            </div>
          </li>
        </ul>
      </div>

    </div>
  </div>

  <div class='row'>
    <div class='col-lg-2 col-lg-offset-2 col-sm-12'>

      <a href="{% url 'campaign-list' %}" class='btn btn-default'>Save and exit</a>

    </div>

    <div class='col-lg-5 col-lg-offset-1 col-sm-12'>

      <form action='{% url "campaign-send-test-email" campaign.id %}' method='post'>
        {% csrf_token %}
        <div class="form-group">
          <div class="input-group">
            <span class="input-group-addon" id="sizing-addon1">
              Send a test email to
            </span>
            <input type="text" name="email" class="form-control" placeholder="your email..." value="{{user.email}}" maxlength=150/>
            <span class="input-group-btn">
              <button type="submit" class="btn btn-default">Send</button>
            </span>
          </div>
        </div>
      </form>

    </div>
  </div>

  <div class='row'>
    <div class='col-lg-8 col-lg-offset-2 text-right'>

      <hr />

      <a href='javascript:void(0)' class='btn btn-primary' disabled>
        {% trans 'Schedule'%}
      </a>

      <a href='{% url "campaign-send" campaign.pk %}' class='btn btn-danger'>
        {% trans 'Send now to'%}
        {{ campaign.email_list.count_subscribers|intcomma }} {% trans 'subscriber' %}{{campaign.email_list.count_subscribers|pluralize}}
      </a>

    </div>
  </div>


{% endblock %}
